<!DOCTYPE html>
<html lang="vi" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>á»¨ng dá»¥ng Thi tráº¯c nghiá»‡m</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header class="navbar navbar-expand-lg bg-body-tertiary border-bottom sticky-top">
    <div class="container-fluid">
      <h1 class="h5 mb-0">á»¨ng dá»¥ng Thi Tráº¯c nghiá»‡m</h1>
      <a href="/history" class="btn btn-secondary">Lá»‹ch sá»­ Thi</a>
    </div>
  </header>

  <main class="container mt-5">
    <div class="card p-4 mx-auto" style="max-width: 600px;">
      <h2 class="h3 text-center mb-4">ChÃ o má»«ng Ä‘áº¿n vá»›i Bá»™ Ä‘á» thi</h2>
      
      <form action="/start" method="POST" class="d-grid gap-2">
        <button type="submit" class="btn btn-primary btn-lg">ğŸš€ Báº¯t Ä‘áº§u bÃ i thi (65 cÃ¢u ngáº«u nhiÃªn)</button>
      </form>
      
      <a href="/study" class="btn btn-success btn-lg mt-3 d-grid gap-2">ğŸ“š Cháº¿ Ä‘á»™ Há»c BÃ i (Xem toÃ n bá»™ cÃ¢u há»i)</a>
      
      <button type="button" class="btn btn-info btn-lg mt-3 d-grid gap-2" id="toggleStatsBtn">
          ğŸ“Š Kiá»ƒm tra Sá»‘ láº§n thi cá»§a tá»«ng cÃ¢u
      </button>
      
    </div>

    <div class="card mt-4 mb-5 d-none" id="statsContainer">
        <div class="card-header bg-secondary text-white">
            <h3 class="h5 mb-0">ğŸ“Š Thá»‘ng kÃª CÃ¢u há»i Ä‘Ã£ thi (Tá»•ng cá»™ng: <%= totalPoolQuestions %> cÃ¢u)</h3>
        </div>
        <div class="card-body">
            
            <% 
                // Logic Ä‘á»ƒ chia máº£ng thÃ nh cÃ¡c cá»™t 50 cÃ¢u
                const COLUMN_SIZE = 50;
                const numColumns = Math.ceil(questionStats.length / COLUMN_SIZE);
                const columns = [];
                
                for(let i = 0; i < numColumns; i++) {
                    columns.push(questionStats.slice(i * COLUMN_SIZE, (i + 1) * COLUMN_SIZE));
                }
            %>
            
            <% if (totalPoolQuestions === 0) { %>
                <div class="alert alert-danger mt-3">Lá»—i: KhÃ´ng tÃ¬m tháº¥y cÃ¢u há»i trong Pool (questions.json).</div>
            <% } else { %>
                <div class="d-flex flex-row overflow-auto stats-container"> 
                    
                    <% columns.forEach((column, colIndex) => { %>
                        <div class="d-flex flex-column me-4 mb-4 flex-shrink-0" style="width: 150px;">
                            
                            <h6 class="text-primary" style="text-align: center;">(CÃ¢u <%= column[0].qNum %> - <%= column[column.length - 1].qNum %>)</h6>
                            <ul class="list-group list-group-flush border rounded shadow-sm">
                                <% column.forEach(stat => { %>
                                    <% 
                                        let backgroundColor = '';
                                        // Highlight mÃ u vÃ ng náº¿u chÆ°a thi láº§n nÃ o
                                        if (stat.count === 0) {
                                            backgroundColor = 'bg-warning text-dark fw-bold'; 
                                        }
                                    %>
                                    <li class="list-group-item d-flex justify-content-between align-items-center p-2 <%= backgroundColor %>">
                                        <span class="text-truncate">CÃ¢u <%= stat.qNum %>:</span>
                                        <span class="badge <%= stat.count === 0 ? 'bg-danger' : 'bg-primary' %> rounded-pill ms-2">
                                            <%= stat.count %> láº§n
                                        </span>
                                    </li>
                                <% }); %>
                            </ul>
                        </div>
                    <% }); %>
                    
                </div>
            <% } %>
        </div>
    </div>
    </main>
  
  <script>
    document.getElementById('toggleStatsBtn').addEventListener('click', function() {
        const statsContainer = document.getElementById('statsContainer');
        const btn = document.getElementById('toggleStatsBtn');
        
        // Toggle (thay Ä‘á»•i tráº¡ng thÃ¡i) class 'd-none'
        statsContainer.classList.toggle('d-none'); 

        // Thay Ä‘á»•i vÄƒn báº£n cá»§a nÃºt
        if (statsContainer.classList.contains('d-none')) {
            btn.innerHTML = 'ğŸ“Š Kiá»ƒm tra Sá»‘ láº§n thi cá»§a tá»«ng cÃ¢u';
        } else {
            btn.innerHTML = 'áº¨n Báº£ng Thá»‘ng kÃª';
        }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>